(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Kinto = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
module.exports=require("babel-core/polyfill");

},{"babel-core/polyfill":2}],2:[function(require,module,exports){

},{}],3:[function(require,module,exports){
function replacer(t,e){return util.isUndefined(e)?""+e:util.isNumber(e)&&!isFinite(e)?e.toString():util.isFunction(e)||util.isRegExp(e)?e.toString():e}function truncate(t,e){return util.isString(t)?t.length<e?t:t.slice(0,e):t}function getMessage(t){return truncate(JSON.stringify(t.actual,replacer),128)+" "+t.operator+" "+truncate(JSON.stringify(t.expected,replacer),128)}function fail(t,e,r,i,s){throw new assert.AssertionError({message:r,actual:t,expected:e,operator:i,stackStartFunction:s})}function ok(t,e){t||fail(t,!0,e,"==",assert.ok)}function _deepEqual(t,e){if(t===e)return!0;if(util.isBuffer(t)&&util.isBuffer(e)){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return util.isDate(t)&&util.isDate(e)?t.getTime()===e.getTime():util.isRegExp(t)&&util.isRegExp(e)?t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase:util.isObject(t)||util.isObject(e)?objEquiv(t,e):t==e}function isArguments(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function objEquiv(t,e){if(util.isNullOrUndefined(t)||util.isNullOrUndefined(e))return!1;if(t.prototype!==e.prototype)return!1;if(util.isPrimitive(t)||util.isPrimitive(e))return t===e;var r=isArguments(t),i=isArguments(e);if(r&&!i||!r&&i)return!1;if(r)return t=pSlice.call(t),e=pSlice.call(e),_deepEqual(t,e);var s,n,a=objectKeys(t),u=objectKeys(e);if(a.length!=u.length)return!1;for(a.sort(),u.sort(),n=a.length-1;n>=0;n--)if(a[n]!=u[n])return!1;for(n=a.length-1;n>=0;n--)if(s=a[n],!_deepEqual(t[s],e[s]))return!1;return!0}function expectedException(t,e){return t&&e?"[object RegExp]"==Object.prototype.toString.call(e)?e.test(t):t instanceof e?!0:e.call({},t)===!0?!0:!1:!1}function _throws(t,e,r,i){var s;util.isString(r)&&(i=r,r=null);try{e()}catch(n){s=n}if(i=(r&&r.name?" ("+r.name+").":".")+(i?" "+i:"."),t&&!s&&fail(s,r,"Missing expected exception"+i),!t&&expectedException(s,r)&&fail(s,r,"Got unwanted exception"+i),t&&s&&r&&!expectedException(s,r)||!t&&s)throw s}var util=require("util/"),pSlice=Array.prototype.slice,hasOwn=Object.prototype.hasOwnProperty,assert=module.exports=ok;assert.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=getMessage(this),this.generatedMessage=!0);var e=t.stackStartFunction||fail;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var r=new Error;if(r.stack){var i=r.stack,s=e.name,n=i.indexOf("\n"+s);if(n>=0){var a=i.indexOf("\n",n+1);i=i.substring(a+1)}this.stack=i}}},util.inherits(assert.AssertionError,Error),assert.fail=fail,assert.ok=ok,assert.equal=function(t,e,r){t!=e&&fail(t,e,r,"==",assert.equal)},assert.notEqual=function(t,e,r){t==e&&fail(t,e,r,"!=",assert.notEqual)},assert.deepEqual=function(t,e,r){_deepEqual(t,e)||fail(t,e,r,"deepEqual",assert.deepEqual)},assert.notDeepEqual=function(t,e,r){_deepEqual(t,e)&&fail(t,e,r,"notDeepEqual",assert.notDeepEqual)},assert.strictEqual=function(t,e,r){t!==e&&fail(t,e,r,"===",assert.strictEqual)},assert.notStrictEqual=function(t,e,r){t===e&&fail(t,e,r,"!==",assert.notStrictEqual)},assert["throws"]=function(t,e,r){_throws.apply(this,[!0].concat(pSlice.call(arguments)))},assert.doesNotThrow=function(t,e){_throws.apply(this,[!1].concat(pSlice.call(arguments)))},assert.ifError=function(t){if(t)throw t};var objectKeys=Object.keys||function(t){var e=[];for(var r in t)hasOwn.call(t,r)&&e.push(r);return e};

},{"util/":9}],4:[function(require,module,exports){

},{}],5:[function(require,module,exports){
function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(e){return"function"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return"object"==typeof e&&null!==e}function isUndefined(e){return void 0===e}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(e){if(!isNumber(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},EventEmitter.prototype.emit=function(e){var t,n,i,s,r,o;if(this._events||(this._events={}),"error"===e&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],isUndefined(n))return!1;if(isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(isObject(n))for(s=Array.prototype.slice.call(arguments,1),o=n.slice(),i=o.length,r=0;i>r;r++)o[r].apply(this,s);return!0},EventEmitter.prototype.addListener=function(e,t){var n;if(!isFunction(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,isFunction(t.listener)?t.listener:t),this._events[e]?isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,isObject(this._events[e])&&!this._events[e].warned&&(n=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!isFunction(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},EventEmitter.prototype.removeListener=function(e,t){var n,i,s,r;if(!isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],s=n.length,i=-1,n===t||isFunction(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(isObject(n)){for(r=s;r-->0;)if(n[r]===t||n[r].listener&&n[r].listener===t){i=r;break}if(0>i)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},EventEmitter.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],isFunction(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},EventEmitter.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},EventEmitter.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(isFunction(t))return 1;if(t)return t.length}return 0},EventEmitter.listenerCount=function(e,t){return e.listenerCount(t)};

},{}],6:[function(require,module,exports){
"function"==typeof Object.create?module.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};

},{}],7:[function(require,module,exports){
function cleanUpNextTick(){draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue()}function drainQueue(){if(!draining){var e=setTimeout(cleanUpNextTick);draining=!0;for(var n=queue.length;n;){for(currentQueue=queue,queue=[];++queueIndex<n;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,n=queue.length}currentQueue=null,draining=!1,clearTimeout(e)}}function Item(e,n){this.fun=e,this.array=n}function noop(){}var process=module.exports={},queue=[],draining=!1,currentQueue,queueIndex=-1;process.nextTick=function(e){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];queue.push(new Item(e,n)),1!==queue.length||draining||setTimeout(drainQueue,0)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};

},{}],8:[function(require,module,exports){
module.exports=function(o){return o&&"object"==typeof o&&"function"==typeof o.copy&&"function"==typeof o.fill&&"function"==typeof o.readUInt8};

},{}],9:[function(require,module,exports){
(function (process,global){
function inspect(e,r){var t={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(t.depth=arguments[2]),arguments.length>=4&&(t.colors=arguments[3]),isBoolean(r)?t.showHidden=r:r&&exports._extend(t,r),isUndefined(t.showHidden)&&(t.showHidden=!1),isUndefined(t.depth)&&(t.depth=2),isUndefined(t.colors)&&(t.colors=!1),isUndefined(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=stylizeWithColor),formatValue(t,e,t.depth)}function stylizeWithColor(e,r){var t=inspect.styles[r];return t?"["+inspect.colors[t][0]+"m"+e+"["+inspect.colors[t][1]+"m":e}function stylizeNoColor(e,r){return e}function arrayToHash(e){var r={};return e.forEach(function(e,t){r[e]=!0}),r}function formatValue(e,r,t){if(e.customInspect&&r&&isFunction(r.inspect)&&r.inspect!==exports.inspect&&(!r.constructor||r.constructor.prototype!==r)){var n=r.inspect(t,e);return isString(n)||(n=formatValue(e,n,t)),n}var i=formatPrimitive(e,r);if(i)return i;var o=Object.keys(r),s=arrayToHash(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(r)),isError(r)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return formatError(r);if(0===o.length){if(isFunction(r)){var u=r.name?": "+r.name:"";return e.stylize("[Function"+u+"]","special")}if(isRegExp(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(isDate(r))return e.stylize(Date.prototype.toString.call(r),"date");if(isError(r))return formatError(r)}var a="",c=!1,l=["{","}"];if(isArray(r)&&(c=!0,l=["[","]"]),isFunction(r)){var p=r.name?": "+r.name:"";a=" [Function"+p+"]"}if(isRegExp(r)&&(a=" "+RegExp.prototype.toString.call(r)),isDate(r)&&(a=" "+Date.prototype.toUTCString.call(r)),isError(r)&&(a=" "+formatError(r)),0===o.length&&(!c||0==r.length))return l[0]+a+l[1];if(0>t)return isRegExp(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special");e.seen.push(r);var f;return f=c?formatArray(e,r,t,s,o):o.map(function(n){return formatProperty(e,r,t,s,n,c)}),e.seen.pop(),reduceToSingleString(f,a,l)}function formatPrimitive(e,r){if(isUndefined(r))return e.stylize("undefined","undefined");if(isString(r)){var t="'"+JSON.stringify(r).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(t,"string")}return isNumber(r)?e.stylize(""+r,"number"):isBoolean(r)?e.stylize(""+r,"boolean"):isNull(r)?e.stylize("null","null"):void 0}function formatError(e){return"["+Error.prototype.toString.call(e)+"]"}function formatArray(e,r,t,n,i){for(var o=[],s=0,u=r.length;u>s;++s)hasOwnProperty(r,String(s))?o.push(formatProperty(e,r,t,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(formatProperty(e,r,t,n,i,!0))}),o}function formatProperty(e,r,t,n,i,o){var s,u,a;if(a=Object.getOwnPropertyDescriptor(r,i)||{value:r[i]},a.get?u=a.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):a.set&&(u=e.stylize("[Setter]","special")),hasOwnProperty(n,i)||(s="["+i+"]"),u||(e.seen.indexOf(a.value)<0?(u=isNull(t)?formatValue(e,a.value,null):formatValue(e,a.value,t-1),u.indexOf("\n")>-1&&(u=o?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n"))):u=e.stylize("[Circular]","special")),isUndefined(s)){if(o&&i.match(/^\d+$/))return u;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+u}function reduceToSingleString(e,r,t){var n=0,i=e.reduce(function(e,r){return n++,r.indexOf("\n")>=0&&n++,e+r.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?t[0]+(""===r?"":r+"\n ")+" "+e.join(",\n  ")+" "+t[1]:t[0]+r+" "+e.join(", ")+" "+t[1]}function isArray(e){return Array.isArray(e)}function isBoolean(e){return"boolean"==typeof e}function isNull(e){return null===e}function isNullOrUndefined(e){return null==e}function isNumber(e){return"number"==typeof e}function isString(e){return"string"==typeof e}function isSymbol(e){return"symbol"==typeof e}function isUndefined(e){return void 0===e}function isRegExp(e){return isObject(e)&&"[object RegExp]"===objectToString(e)}function isObject(e){return"object"==typeof e&&null!==e}function isDate(e){return isObject(e)&&"[object Date]"===objectToString(e)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(e){return"function"==typeof e}function isPrimitive(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function objectToString(e){return Object.prototype.toString.call(e)}function pad(e){return 10>e?"0"+e.toString(10):e.toString(10)}function timestamp(){var e=new Date,r=[pad(e.getHours()),pad(e.getMinutes()),pad(e.getSeconds())].join(":");return[e.getDate(),months[e.getMonth()],r].join(" ")}function hasOwnProperty(e,r){return Object.prototype.hasOwnProperty.call(e,r)}var formatRegExp=/%[sdj%]/g;exports.format=function(e){if(!isString(e)){for(var r=[],t=0;t<arguments.length;t++)r.push(inspect(arguments[t]));return r.join(" ")}for(var t=1,n=arguments,i=n.length,o=String(e).replace(formatRegExp,function(e){if("%%"===e)return"%";if(t>=i)return e;switch(e){case"%s":return String(n[t++]);case"%d":return Number(n[t++]);case"%j":try{return JSON.stringify(n[t++])}catch(r){return"[Circular]"}default:return e}}),s=n[t];i>t;s=n[++t])o+=isNull(s)||!isObject(s)?" "+s:" "+inspect(s);return o},exports.deprecate=function(e,r){function t(){if(!n){if(process.throwDeprecation)throw new Error(r);process.traceDeprecation?console.trace(r):console.error(r),n=!0}return e.apply(this,arguments)}if(isUndefined(global.process))return function(){return exports.deprecate(e,r).apply(this,arguments)};if(process.noDeprecation===!0)return e;var n=!1;return t};var debugs={},debugEnviron;exports.debuglog=function(e){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),e=e.toUpperCase(),!debugs[e])if(new RegExp("\\b"+e+"\\b","i").test(debugEnviron)){var r=process.pid;debugs[e]=function(){var t=exports.format.apply(exports,arguments);console.error("%s %d: %s",e,r,t)}}else debugs[e]=function(){};return debugs[e]},exports.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=require("./support/isBuffer");var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))},exports.inherits=require("inherits"),exports._extend=function(e,r){if(!r||!isObject(r))return e;for(var t=Object.keys(r),n=t.length;n--;)e[t[n]]=r[t[n]];return e};

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./support/isBuffer":8,"_process":7,"inherits":6}],10:[function(require,module,exports){
(function (global){
var rng;if(global.crypto&&crypto.getRandomValues){var _rnds8=new Uint8Array(16);rng=function(){return crypto.getRandomValues(_rnds8),_rnds8}}if(!rng){var _rnds=new Array(16);rng=function(){for(var r,n=0;16>n;n++)0===(3&n)&&(r=4294967296*Math.random()),_rnds[n]=r>>>((3&n)<<3)&255;return _rnds}}module.exports=rng;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],11:[function(require,module,exports){
function parse(e,s,r){var t=s&&r||0,n=0;for(s=s||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>n&&(s[t+n++]=_hexToByte[e])});16>n;)s[t+n++]=0;return s}function unparse(e,s){var r=s||0,t=_byteToHex;return t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]}function v1(e,s,r){var t=s&&r||0,n=s||[];e=e||{};var o=void 0!==e.clockseq?e.clockseq:_clockseq,a=void 0!==e.msecs?e.msecs:(new Date).getTime(),u=void 0!==e.nsecs?e.nsecs:_lastNSecs+1,c=a-_lastMSecs+(u-_lastNSecs)/1e4;if(0>c&&void 0===e.clockseq&&(o=o+1&16383),(0>c||a>_lastMSecs)&&void 0===e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=a,_lastNSecs=u,_clockseq=o,a+=122192928e5;var i=(1e4*(268435455&a)+u)%4294967296;n[t++]=i>>>24&255,n[t++]=i>>>16&255,n[t++]=i>>>8&255,n[t++]=255&i;var _=a/4294967296*1e4&268435455;n[t++]=_>>>8&255,n[t++]=255&_,n[t++]=_>>>24&15|16,n[t++]=_>>>16&255,n[t++]=o>>>8|128,n[t++]=255&o;for(var d=e.node||_nodeId,v=0;6>v;v++)n[t+v]=d[v];return s?s:unparse(n)}function v4(e,s,r){var t=s&&r||0;"string"==typeof e&&(s="binary"==e?new Array(16):null,e=null),e=e||{};var n=e.random||(e.rng||_rng)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,s)for(var o=0;16>o;o++)s[t+o]=n[o];return s||unparse(n)}for(var _rng=require("./rng"),_byteToHex=[],_hexToByte={},i=0;256>i;i++)_byteToHex[i]=(i+256).toString(16).substr(1),_hexToByte[_byteToHex[i]]=i;var _seedBytes=_rng(),_nodeId=[1|_seedBytes[0],_seedBytes[1],_seedBytes[2],_seedBytes[3],_seedBytes[4],_seedBytes[5]],_clockseq=16383&(_seedBytes[6]<<8|_seedBytes[7]),_lastMSecs=0,_lastNSecs=0,uuid=v4;uuid.v1=v1,uuid.v4=v4,uuid.parse=parse,uuid.unparse=unparse,module.exports=uuid;

},{"./rng":10}],12:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),_api=require("./api"),_api2=_interopRequireDefault(_api),_collection=require("./collection"),_collection2=_interopRequireDefault(_collection),_adaptersBase=require("./adapters/base"),_adaptersBase2=_interopRequireDefault(_adaptersBase),DEFAULT_BUCKET_NAME="default",DEFAULT_REMOTE="http://localhost:8888/v1",KintoBase=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];_classCallCheck(this,e);var r={bucket:DEFAULT_BUCKET_NAME,remote:DEFAULT_REMOTE};if(this._options=Object.assign(r,t),!this._options.adapter)throw new Error("No adapter provided");var a=this._options,n=a.remote,o=a.events,s=a.headers,i=a.requestMode;this._api=new _api2["default"](n,o,{headers:s,requestMode:i}),this.events=this._options.events}return _createClass(e,null,[{key:"adapters",get:function(){return{BaseAdapter:_adaptersBase2["default"]}}},{key:"syncStrategy",get:function(){return _collection2["default"].strategy}}]),_createClass(e,[{key:"collection",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!e)throw new Error("missing collection name");var r=this._options.bucket;return new _collection2["default"](r,e,this._api,{events:this._options.events,adapter:this._options.adapter,dbPrefix:this._options.dbPrefix,idSchema:t.idSchema,remoteTransformers:t.remoteTransformers})}}]),e}();exports["default"]=KintoBase,module.exports=exports["default"];

},{"./adapters/base":15,"./api":16,"./collection":17}],13:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _toConsumableArray(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _inherits(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),_get=function(e,r,t){for(var n=!0;n;){var o=e,a=r,u=t;n=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,a);if(void 0!==i){if("value"in i)return i.value;var c=i.get;return void 0===c?void 0:c.call(u)}var s=Object.getPrototypeOf(o);if(null===s)return void 0;e=s,r=a,t=u,n=!0,i=s=void 0}},_baseJs=require("./base.js"),_baseJs2=_interopRequireDefault(_baseJs),IDB=function(e){function r(e){_classCallCheck(this,r),_get(Object.getPrototypeOf(r.prototype),"constructor",this).call(this),this._db=null,this.dbname=e}return _inherits(r,e),_createClass(r,[{key:"_handleError",value:function(e){return function(r){var t=new Error(e+"() "+r.message);throw t.stack=r.stack,t}}},{key:"open",value:function(){var e=this;return this._db?Promise.resolve(this):new Promise(function(r,t){var n=indexedDB.open(e.dbname,1);n.onupgradeneeded=function(r){var t=r.target.result,n=t.createObjectStore(e.dbname,{keyPath:"id"});n.createIndex("id","id",{unique:!0}),n.createIndex("_status","_status"),n.createIndex("last_modified","last_modified");var o=t.createObjectStore("__meta__",{keyPath:"name"});o.createIndex("name","name",{unique:!0})},n.onerror=function(e){return t(e.target.error)},n.onsuccess=function(t){e._db=t.target.result,r(e)}})}},{key:"close",value:function(){return this._db&&(this._db.close(),this._db=null),_get(Object.getPrototypeOf(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(){var e=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0],r=arguments.length<=1||void 0===arguments[1]?null:arguments[1],t=r||this.dbname,n=e?this._db.transaction([t],e):this._db.transaction([t]),o=n.objectStore(t);return{transaction:n,store:o}}},{key:"clear",value:function(){var e=this;return this.open().then(function(){return new Promise(function(r,t){var n=e.prepare("readwrite"),o=n.transaction,a=n.store;a.clear(),o.onerror=function(e){return t(new Error(e.target.error))},o.oncomplete=function(){return r()}})})["catch"](this._handleError("clear"))}},{key:"create",value:function(e){var r=this;return this.open().then(function(){return new Promise(function(t,n){var o=r.prepare("readwrite"),a=o.transaction,u=o.store;u.add(e),a.onerror=function(e){return n(new Error(e.target.error))},a.oncomplete=function(){return t(e)}})})["catch"](this._handleError("create"))}},{key:"update",value:function(e){var r=this;return this.open().then(function(){return new Promise(function(t,n){var o=r.prepare("readwrite"),a=o.transaction,u=o.store;u.put(e),a.onerror=function(e){return n(new Error(e.target.error))},a.oncomplete=function(){return t(e)}})})["catch"](this._handleError("update"))}},{key:"get",value:function(e){var r=this;return this.open().then(function(){return new Promise(function(t,n){var o=r.prepare(),a=o.transaction,u=o.store,i=u.get(e);a.onerror=function(e){return n(new Error(e.target.error))},a.oncomplete=function(){return t(i.result)}})})["catch"](this._handleError("get"))}},{key:"delete",value:function(e){var r=this;return this.open().then(function(){return new Promise(function(t,n){var o=r.prepare("readwrite"),a=o.transaction,u=o.store;u["delete"](e),a.onerror=function(e){return n(new Error(e.target.error))},a.oncomplete=function(){return t(e)}})})["catch"](this._handleError("delete"))}},{key:"list",value:function(){var e=this;return this.open().then(function(){return new Promise(function(r,t){var n=[],o=e.prepare(),a=o.transaction,u=o.store,i=u.openCursor();i.onsuccess=function(e){var r=e.target.result;r&&(n.push(r.value),r["continue"]())},a.onerror=function(e){return t(new Error(e.target.error))},a.oncomplete=function(e){return r(n)}})})["catch"](this._handleError("list"))}},{key:"saveLastModified",value:function(e){var r=this,t=parseInt(e,10)||null;return this.open().then(function(){return new Promise(function(e,n){var o=r.prepare("readwrite","__meta__"),a=o.transaction,u=o.store;u.put({name:"lastModified",value:t}),a.onerror=function(e){return n(e.target.error)},a.oncomplete=function(r){return e(t)}})})}},{key:"getLastModified",value:function(){var e=this;return this.open().then(function(){return new Promise(function(r,t){var n=e.prepare(void 0,"__meta__"),o=n.transaction,a=n.store,u=a.get("lastModified");o.onerror=function(e){return t(e.target.error)},o.oncomplete=function(e){r(u.result&&u.result.value||null)}})})}},{key:"loadDump",value:function(e){var r=this;return this.open().then(function(){return new Promise(function(t,n){var o=r.prepare("readwrite"),a=o.transaction,u=o.store;e.forEach(function(e){return u.put(e)});var i=Math.max.apply(Math,_toConsumableArray(e.map(function(e){return e.last_modified})));a.onerror=function(e){return n(new Error(e.target.error))},a.oncomplete=function(){t(r.getLastModified().then(function(e){return i>e?r.saveLastModified(i):void 0}).then(function(){return e}))}})})["catch"](this._handleError("loadDump"))}}]),r}(_baseJs2["default"]);exports["default"]=IDB,module.exports=exports["default"];

},{"./base.js":15}],14:[function(require,module,exports){
(function (global){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),_get=function(e,t,r){for(var o=!0;o;){var a=e,n=t,i=r;o=!1,null===a&&(a=Function.prototype);var s=Object.getOwnPropertyDescriptor(a,n);if(void 0!==s){if("value"in s)return s.value;var l=s.get;return void 0===l?void 0:l.call(i)}var u=Object.getPrototypeOf(a);if(null===u)return void 0;e=u,t=n,r=i,o=!0,s=u=void 0}},_baseJs=require("./base.js"),_baseJs2=_interopRequireDefault(_baseJs),root="object"==typeof window?window:global;root.hasOwnProperty("localStorage")||(root.localStorage=require("localStorage"));var LocalStorage=function(e){function t(e){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this._db=null,this._keyStoreName=this.dbname+"/__keys",this._keyLastModified=this.dbname+"/__lastModified",this.dbname=e}return _inherits(t,e),_createClass(t,[{key:"_handleError",value:function(e,t){var r=new Error(e+"() "+t.message);return r.stack=t.stack,Promise.reject(r)}},{key:"open",value:function(){return _get(Object.getPrototypeOf(t.prototype),"open",this).call(this)}},{key:"close",value:function(){return _get(Object.getPrototypeOf(t.prototype),"close",this).call(this)}},{key:"clear",value:function(){try{return localStorage.clear(),Promise.resolve()}catch(e){return this._handleError("clear",e)}}},{key:"create",value:function(e){if(-1!==this.keys.indexOf(e.id))return Promise.reject(new Error("Exists."));try{return localStorage.setItem(this.dbname+"/"+e.id,JSON.stringify(e)),this.keys=this.keys.concat(e.id),Promise.resolve(e)}catch(t){return this._handleError("create",t)}}},{key:"update",value:function(e){if(-1===this.keys.indexOf(e.id))return Promise.reject(new Error("Doesn't exist."));try{return localStorage.setItem(this.dbname+"/"+e.id,JSON.stringify(e)),Promise.resolve(e)}catch(t){return this._handleError("update",t)}}},{key:"get",value:function(e){try{return Promise.resolve(JSON.parse(localStorage.getItem(this.dbname+"/"+e))||void 0)}catch(t){return this._handleError("get",t)}}},{key:"delete",value:function(e){try{return localStorage.removeItem(this.dbname+"/"+e),this.keys=this.keys.filter(function(t){return t!==e}),Promise.resolve(e)}catch(t){return this._handleError("delete",t)}}},{key:"list",value:function(){var e=this;try{return Promise.resolve(this.keys.map(function(t){return JSON.parse(localStorage.getItem(e.dbname+"/"+t))}))}catch(t){return this._handleError("list",t)}}},{key:"saveLastModified",value:function(e){var t=parseInt(e,10);try{return localStorage.setItem(this._keyLastModified,JSON.stringify(t)),Promise.resolve(t)}catch(r){return this._handleError("saveLastModified",r)}}},{key:"getLastModified",value:function(){try{var e=JSON.parse(localStorage.getItem(this._keyLastModified));return Promise.resolve(parseInt(e,10)||null)}catch(t){return this._handleError("getLastModified",t)}}},{key:"loadDump",value:function(e){var t=this;try{var r=function(){e.forEach(function(e){localStorage.setItem(t.dbname+"/"+e.id,JSON.stringify(e)),-1===t.keys.indexOf(e.id)&&(t.keys=t.keys.concat(e.id))});var r=Math.max.apply(Math,_toConsumableArray(e.map(function(e){return e.last_modified})));return{v:t.getLastModified().then(function(e){return r>e?t.saveLastModified(r):void 0}).then(function(){return e})}}();if("object"==typeof r)return r.v}catch(o){return this._handleError("loadDump",o)}}},{key:"keys",get:function(){return JSON.parse(localStorage.getItem(this._keyStoreName))||[]},set:function(e){localStorage.setItem(this._keyStoreName,JSON.stringify(e))}}]),t}(_baseJs2["default"]);exports["default"]=LocalStorage,module.exports=exports["default"];

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./base.js":15,"localStorage":4}],15:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),BaseAdapter=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"open",value:function(){return Promise.resolve()}},{key:"close",value:function(){return Promise.resolve()}},{key:"clear",value:function(){throw new Error("Not Implemented.")}},{key:"create",value:function(e){throw new Error("Not Implemented.")}},{key:"update",value:function(e){throw new Error("Not Implemented.")}},{key:"get",value:function(e){throw new Error("Not Implemented.")}},{key:"delete",value:function(e){throw new Error("Not Implemented.")}},{key:"list",value:function(){throw new Error("Not Implemented.")}},{key:"saveLastModified",value:function(e){throw new Error("Not Implemented.")}},{key:"getLastModified",value:function(){throw new Error("Not Implemented.")}},{key:"loadDump",value:function(e){throw new Error("Not Implemented.")}}]),e}();exports["default"]=BaseAdapter,module.exports=exports["default"];

},{}],16:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cleanRecord(e){var t=arguments.length<=1||void 0===arguments[1]?RECORD_FIELDS_TO_CLEAN:arguments[1];return Object.keys(e).reduce(function(r,s){return-1===t.indexOf(s)&&(r[s]=e[s]),r},{})}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,r,s){return r&&e(t.prototype,r),s&&e(t,s),t}}();exports.cleanRecord=cleanRecord;var _utilsJs=require("./utils.js"),_httpJs=require("./http.js"),_httpJs2=_interopRequireDefault(_httpJs),RECORD_FIELDS_TO_CLEAN=["_status","last_modified"],SUPPORTED_PROTOCOL_VERSION="v1";exports.SUPPORTED_PROTOCOL_VERSION=SUPPORTED_PROTOCOL_VERSION;var Api=function(){function e(t,r){var s=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(_classCallCheck(this,e),"string"!=typeof t||!t.length)throw new Error("Invalid remote URL: "+t);if("/"===t[t.length-1]&&(t=t.slice(0,-1)),this._backoffReleaseTime=null,this.remote=t,this.optionHeaders=s.headers||{},this.serverSettings=null,!r)throw new Error("No events handler provided");this.events=r,this.http=new _httpJs2["default"](this.events,{requestMode:s.requestMode}),this._registerHTTPEvents()}return _createClass(e,[{key:"_registerHTTPEvents",value:function(){var e=this;this.events.on("backoff",function(t){e._backoffReleaseTime=t})}},{key:"endpoints",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{fullUrl:!0}:arguments[0],t=e.fullUrl?this.remote:"/"+this.version,r={root:function(){return t+"/"},batch:function(){return t+"/batch"},bucket:function(e){return t+"/buckets/"+e},collection:function(e,t){return r.bucket(e)+"/collections/"+t},records:function(e,t){return r.collection(e,t)+"/records"},record:function(e,t,s){return r.records(e,t)+"/"+s}};return r}},{key:"fetchServerSettings",value:function(){var e=this;return this.serverSettings?Promise.resolve(this.serverSettings):this.http.request(this.endpoints().root()).then(function(t){return e.serverSettings=t.json.settings,e.serverSettings})}},{key:"fetchChangesSince",value:function(e,t){var r=this,s=arguments.length<=2||void 0===arguments[2]?{lastModified:null,headers:{}}:arguments[2],n=this.endpoints().records(e,t),i="",o=Object.assign({},this.optionHeaders,s.headers);return s.lastModified&&(i="?_since="+s.lastModified,o["If-None-Match"]=(0,_utilsJs.quote)(s.lastModified)),this.fetchServerSettings().then(function(e){return r.http.request(n+i,{headers:o})}).then(function(e){if(304===e.status)return{lastModified:s.lastModified,changes:[]};var t=e.headers.get("ETag");t=t?parseInt((0,_utilsJs.unquote)(t),10):s.lastModified;var r=e.json.data,n=s.lastModified,i=t>s.lastModified,o=r?0===r.length:!0;if(n&&i&&o)throw Error("Server has been flushed.");return{lastModified:t,changes:r}})}},{key:"_buildRecordBatchRequest",value:function(e,t,r){var s="deleted"===e._status,n=s?"DELETE":"PUT",i=s?void 0:{data:cleanRecord(e)},o={};return r&&(e.last_modified?o["If-Match"]=(0,_utilsJs.quote)(e.last_modified):s||(o["If-None-Match"]="*")),{method:n,headers:o,path:t,body:i}}},{key:"_processBatchResponses",value:function(e,t,r){return r.json.responses.forEach(function(r,s){r.status&&r.status>=200&&r.status<400?e.published.push(r.body.data):404===r.status?e.skipped.push(t[s]):412===r.status?e.conflicts.push({type:"outgoing",local:t[s],remote:r.body.details&&r.body.details.existing||null}):e.errors.push({path:r.path,sent:t[s],error:r.body})}),e}},{key:"batch",value:function(e,t,r){var s=this,n=arguments.length<=3||void 0===arguments[3]?{headers:{}}:arguments[3],i=n.safe||!0,o=Object.assign({},this.optionHeaders,n.headers),a={errors:[],published:[],conflicts:[],skipped:[]};return r.length?this.fetchServerSettings().then(function(u){var c=u.batch_max_requests||u["cliquet.batch_max_requests"];return c&&r.length>c?Promise.all((0,_utilsJs.partition)(r,c).map(function(r){return s.batch(e,t,r,n)})).then(function(e){return e.reduce(function(e,t){return Object.keys(t).forEach(function(r){e[r]=a[r].concat(t[r])}),e},a)}):s.http.request(s.endpoints().batch(),{method:"POST",headers:o,body:JSON.stringify({defaults:{headers:o},requests:r.map(function(r){var n=s.endpoints({full:!1}).record(e,t,r.id);return s._buildRecordBatchRequest(r,n,i)})})}).then(function(e){return s._processBatchResponses(a,r,e)})}):Promise.resolve(a)}},{key:"remote",get:function(){return this._remote},set:function(e){var t=void 0;try{t=e.match(/\/(v\d+)\/?$/)[1]}catch(r){throw new Error("The remote URL must contain the version: "+e)}if(t!==SUPPORTED_PROTOCOL_VERSION)throw new Error("Unsupported protocol version: "+t);this._remote=e,this._version=t}},{key:"version",get:function(){return this._version}},{key:"backoff",get:function(){var e=(new Date).getTime();return this._backoffReleaseTime&&e<this._backoffReleaseTime?this._backoffReleaseTime-e:0}}]),e}();exports["default"]=Api;

},{"./http.js":19,"./utils.js":21}],17:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function createUUIDSchema(){return{generate:function(){return(0,_uuid.v4)()},validate:function(e){return(0,_utils.isUUID)(e)}}}Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(u){i=!0,a=u}finally{try{!n&&o["return"]&&o["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_adaptersBase=require("./adapters/base"),_adaptersBase2=_interopRequireDefault(_adaptersBase),_utils=require("./utils"),_api=require("./api"),_uuid=require("uuid"),SyncResultObject=function(){function e(){_classCallCheck(this,e),this.ok=!0,Object.assign(this,e.defaults)}return _createClass(e,null,[{key:"defaults",get:function(){return{ok:!0,lastModified:null,errors:[],created:[],updated:[],deleted:[],published:[],conflicts:[],skipped:[],resolved:[]}}}]),_createClass(e,[{key:"add",value:function(e,t){return Array.isArray(this[e])?(this[e]=this[e].concat(t),this.ok=this.errors.length+this.conflicts.length===0,this):void 0}},{key:"reset",value:function(t){return this[t]=e.defaults[t],this.ok=this.errors.length+this.conflicts.length===0,this}}]),e}();exports.SyncResultObject=SyncResultObject;var Collection=function(){function e(t,r,n){var i=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];_classCallCheck(this,e),this._bucket=t,this._name=r,this._lastModified=null;var a=i.adapter;if(!a)throw new Error("No adapter provided");var s=i.dbPrefix||"",o=new a(""+s+t+"/"+r);if(!(o instanceof _adaptersBase2["default"]))throw new Error("Unsupported adapter.");this.db=o,this.api=n,this.events=i.events,this.idSchema=this._validateIdSchema(i.idSchema),this.remoteTransformers=this._validateRemoteTransformers(i.remoteTransformers)}return _createClass(e,[{key:"_validateIdSchema",value:function(e){if("undefined"==typeof e)return createUUIDSchema();if("object"!=typeof e)throw new Error("idSchema must be an object.");if("function"!=typeof e.generate)throw new Error("idSchema must provide a generate function.");if("function"!=typeof e.validate)throw new Error("idSchema must provide a validate function.");return e}},{key:"_validateRemoteTransformers",value:function(e){if("undefined"==typeof e)return[];if(!Array.isArray(e))throw new Error("remoteTransformers should be an array.");return e.map(function(e){if("object"!=typeof e)throw new Error("A transformer must be an object.");if("function"!=typeof e.encode)throw new Error("A transformer must provide an encode function.");if("function"!=typeof e.decode)throw new Error("A transformer must provide a decode function.");return e})}},{key:"clear",value:function(){var e=this;return this.db.clear().then(function(t){return e.db.saveLastModified(null)}).then(function(e){return{data:[],permissions:{}}})}},{key:"_encodeRecord",value:function(e,t){return this[e+"Transformers"].length?(0,_utils.waterfall)(this[e+"Transformers"].map(function(e){return function(t){return e.encode(t)}}),t):Promise.resolve(t)}},{key:"_decodeRecord",value:function(e,t){return this[e+"Transformers"].length?(0,_utils.waterfall)(this[e+"Transformers"].reverse().map(function(e){return function(t){return e.decode(t)}}),t):Promise.resolve(t)}},{key:"create",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{useRecordId:!1,synced:!1}:arguments[1],r=function(e){return Promise.reject(new Error(e))};if("object"!=typeof e)return r("Record is not an object.");if((t.synced||t.useRecordId)&&!e.id)return r("Missing required Id; synced and useRecordId options require one");if(!t.synced&&!t.useRecordId&&e.id)return r("Extraneous Id; can't create a record having one set.");var n=Object.assign({},e,{id:t.synced||t.useRecordId?e.id:this.idSchema.generate(),_status:t.synced?"synced":"created"});return this.idSchema.validate(n.id)?this.db.create(n).then(function(e){return{data:e,permissions:{}}}):r("Invalid Id: "+n.id)}},{key:"update",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{synced:!1}:arguments[1];return"object"!=typeof e?Promise.reject(new Error("Record is not an object.")):e.id?this.idSchema.validate(e.id)?this.get(e.id).then(function(n){var i="updated";"deleted"===e._status?i="deleted":r.synced&&(i="synced");var a=Object.assign({},e,{_status:i});return t.db.update(a).then(function(e){return{data:e,permissions:{}}})}):Promise.reject(new Error("Invalid Id: "+e.id)):Promise.reject(new Error("Cannot update a record missing id."))}},{key:"get",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{includeDeleted:!1}:arguments[1];return this.idSchema.validate(e)?this.db.get(e).then(function(r){if(!r||!t.includeDeleted&&"deleted"===r._status)throw new Error("Record with id="+e+" not found.");return{data:r,permissions:{}}}):Promise.reject(Error("Invalid Id: "+e))}},{key:"delete",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{virtual:!0}:arguments[1];return this.idSchema.validate(e)?this.get(e,{includeDeleted:!0}).then(function(n){return r.virtual?"deleted"===n.data._status?Promise.resolve({data:{id:e},permissions:{}}):t.update(Object.assign({},n.data,{_status:"deleted"})):t.db["delete"](e).then(function(e){return{data:{id:e},permissions:{}}})}):Promise.reject(new Error("Invalid Id: "+e))}},{key:"list",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=arguments.length<=1||void 0===arguments[1]?{includeDeleted:!1}:arguments[1];return e=Object.assign({order:"-last_modified",filters:{}},e),this.db.list().then(function(r){var n=(0,_utils.reduceRecords)(e.filters,e.order,r);return t.includeDeleted||(n=n.filter(function(e){return"deleted"!==e._status})),{data:n,permissions:{}}})}},{key:"_processChangeImport",value:function(e,t){var r=(0,_utils.deepEquals)((0,_api.cleanRecord)(e),(0,_api.cleanRecord)(t));return"synced"!==e._status?"deleted"===e._status?{type:"skipped",data:e}:r?this.update(t,{synced:!0}).then(function(e){return{type:"updated",data:e.data}}):{type:"conflicts",data:{type:"incoming",local:e,remote:t}}:t.deleted?this["delete"](t.id,{virtual:!1}).then(function(e){return{type:"deleted",data:e.data}}):this.update(t,{synced:!0}).then(function(e){var t=r?"void":"updated";return{type:t,data:e.data}})}},{key:"_importChange",value:function(e){var t=this,r=void 0,n=void 0;return n=e.deleted?Promise.resolve(e):this._decodeRecord("remote",e),n.then(function(e){return r=e,t.get(r.id,{includeDeleted:!0})}).then(function(e){return t._processChangeImport(e.data,r)})["catch"](function(e){return/not found/i.test(e.message)?r.deleted?{type:"skipped",data:r}:t.create(r,{synced:!0}).then(function(e){return{type:"created",data:e.data}})["catch"](function(e){return{type:"errors",data:e}}):(e.type="incoming",{type:"errors",data:e})})}},{key:"importChanges",value:function(e,t){var r=this;return Promise.all(t.changes.map(function(e){return r._importChange(e)})).then(function(t){var r=!0,n=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var o=a.value;"void"!==o.type&&e.add(o.type,o.data)}}catch(u){n=!0,i=u}finally{try{!r&&s["return"]&&s["return"]()}finally{if(n)throw i}}return e}).then(function(e){return e.lastModified=t.lastModified,e.ok?r.db.saveLastModified(e.lastModified).then(function(t){return r._lastModified=t,e}):e})}},{key:"resetSyncStatus",value:function(){var e=this,t=void 0;return this.list({},{includeDeleted:!0}).then(function(t){return Promise.all(t.data.map(function(t){return"deleted"===t._status?e.db["delete"](t.id):e.db.update(Object.assign({},t,{last_modified:void 0,_status:"created"}))}))}).then(function(r){return t=r.length,e.db.saveLastModified(null)}).then(function(e){return t})}},{key:"gatherLocalChanges",value:function(){var e=this,t=void 0;return this.list({},{includeDeleted:!0}).then(function(e){return e.data.reduce(function(e,t){return"deleted"!==t._status||t.last_modified?"synced"!==t._status&&e.toSync.push(t):e.toDelete.push(t),e},{toDelete:[],toSync:[]})}).then(function(r){var n=r.toDelete,i=r.toSync;return t=n,Promise.all(i.map(e._encodeRecord.bind(e,"remote")))}).then(function(e){return{toDelete:t,toSync:e}})}},{key:"pullChanges",value:function(t){var r=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return t.ok?(n=Object.assign({strategy:e.strategy.MANUAL,lastModified:this.lastModified,headers:{}},n),this.api.fetchChangesSince(this.bucket,this.name,{lastModified:n.lastModified,headers:n.headers}).then(function(e){return r.importChanges(t,e)}).then(function(e){return r._handleConflicts(e,n.strategy)})):Promise.resolve(t)}},{key:"pushChanges",value:function(t){var r=this,n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(!t.ok)return Promise.resolve(t);var i=n.strategy===e.SERVER_WINS;return n=Object.assign({safe:i},n),this.gatherLocalChanges().then(function(e){var t=e.toDelete,i=e.toSync;return Promise.all([Promise.all(t.map(function(e){return r["delete"](e.id,{virtual:!1})})),r.api.batch(r.bucket,r.name,i,n)])}).then(function(e){var n=_slicedToArray(e,2),i=(n[0],n[1]),a=i.errors,s=i.conflicts,o=i.published,u=i.skipped;t.add("errors",a.map(function(e){return e.type="outgoing",e})),t.add("conflicts",s);var d=u.map(function(e){return _extends({},e,{deleted:!0})}),c=o.concat(d);return Promise.all(c.map(function(e){return e.deleted?r["delete"](e.id,{virtual:!1}).then(function(e){return{data:{id:e.data.id,deleted:!0}}}):r._decodeRecord("remote",e).then(function(e){return r.update(e,{synced:!0})})})).then(function(e){return t.add("published",e.map(function(e){return e.data})),t})}).then(function(e){return r._handleConflicts(e,n.strategy)}).then(function(t){var i=t.resolved.filter(function(e){return"synced"!==e._status});return 0===i.length||n.resolved?t:n.strategy!==e.strategy.CLIENT_WINS||n.resolved?n.strategy===e.strategy.SERVER_WINS?Promise.all(i.map(function(e){return r.update(e,{synced:!0})})).then(function(e){return t}):void 0:r.pushChanges(t,Object.assign({},n,{resolved:!0}))})}},{key:"resolve",value:function(e,t){return this.update(Object.assign({},t,{last_modified:e.remote.last_modified}))}},{key:"_handleConflicts",value:function(t){var r=this,n=arguments.length<=1||void 0===arguments[1]?e.strategy.MANUAL:arguments[1];return n===e.strategy.MANUAL||0===t.conflicts.length?Promise.resolve(t):Promise.all(t.conflicts.map(function(t){var i=n===e.strategy.CLIENT_WINS?t.local:t.remote;return r.resolve(t,i)})).then(function(e){return t.reset("conflicts").add("resolved",e.map(function(e){return e.data}))})}},{key:"sync",value:function(){var t=this,r=arguments.length<=0||void 0===arguments[0]?{strategy:e.strategy.MANUAL,headers:{},ignoreBackoff:!1,remote:null}:arguments[0],n=this.api.remote;if(r.remote&&(this.api.remote=r.remote),!r.ignoreBackoff&&this.api.backoff>0){var i=Math.ceil(this.api.backoff/1e3);return Promise.reject(new Error("Server is backed off; retry in "+i+"s or use the ignoreBackoff option."))}var a=new SyncResultObject,s=this.db.getLastModified().then(function(e){return t._lastModified=e}).then(function(e){return t.pullChanges(a,r)}).then(function(e){return t.pushChanges(e,r)}).then(function(e){return 0===e.published.length?e:t.pullChanges(e,r)});return(0,_utils.pFinally)(s,function(){return t.api.remote=n})}},{key:"loadDump",value:function(e){var t=this,r=function(e){return Promise.reject(new Error(e))};if(!Array.isArray(e))return r("Records is not an array.");var n=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var u=s.value;if(!u.id||!this.idSchema.validate(u.id))return r("Record has invalid ID: "+JSON.stringify(u));if(!u.last_modified)return r("Record has no last_modified value: "+JSON.stringify(u))}}catch(d){i=!0,a=d}finally{try{!n&&o["return"]&&o["return"]()}finally{if(i)throw a}}return this.list({},{includeDeleted:!0}).then(function(e){return e.data.reduce(function(e,t){return e[t.id]=t,e},{})}).then(function(t){return e.filter(function(e){var r=t[e.id],n=void 0===r||"synced"===r._status&&void 0!==r.last_modified&&e.last_modified>r.last_modified;return n})}).then(function(e){return e.map(function(e){return Object.assign({},e,{_status:"synced"})})}).then(function(e){return t.db.loadDump(e)})}},{key:"name",get:function(){return this._name}},{key:"bucket",get:function(){return this._bucket}},{key:"lastModified",get:function(){return this._lastModified}}],[{key:"strategy",get:function(){return{CLIENT_WINS:"client_wins",SERVER_WINS:"server_wins",MANUAL:"manual"}}}]),e}();exports["default"]=Collection;

},{"./adapters/base":15,"./api":16,"./utils":21,"uuid":11}],18:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]={104:"Missing Authorization Token",105:"Invalid Authorization Token",106:"Request body was not valid JSON",107:"Invalid request parameter",108:"Missing request parameter",109:"Invalid posted data",110:"Invalid Token / id",111:"Missing Token / id",112:"Content-Length header was not provided",113:"Request body too large",114:"Resource was modified meanwhile",115:"Method not allowed on this end point",116:"Requested version not available on this server",117:"Client has sent too many requests",121:"Resource access is forbidden for this user",122:"Another resource violates constraint",201:"Service Temporary unavailable due to high load",202:"Service deprecated",999:"Internal Server Error"},module.exports=exports["default"];

},{}],19:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_errorsJs=require("./errors.js"),_errorsJs2=_interopRequireDefault(_errorsJs),HTTP=function(){function e(t){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(_classCallCheck(this,e),!t)throw new Error("No events handler provided");this.events=t,r=Object.assign({},e.defaultOptions,r),this.requestMode=r.requestMode,this.timeout=r.timeout}return _createClass(e,null,[{key:"DEFAULT_REQUEST_HEADERS",get:function(){return{Accept:"application/json","Content-Type":"application/json"}}},{key:"defaultOptions",get:function(){return{timeout:5e3,requestMode:"cors"}}}]),_createClass(e,[{key:"request",value:function(t){var r=this,n=arguments.length<=1||void 0===arguments[1]?{headers:{}}:arguments[1],o=void 0,s=void 0,a=void 0,u=void 0,i=void 0,c=void 0;return n.headers=Object.assign({},e.DEFAULT_REQUEST_HEADERS,n.headers),n.mode=this.requestMode,new Promise(function(e,o){i=setTimeout(function(){c=!0,o(new Error("Request timeout."))},r.timeout),fetch(t,n).then(function(t){c||(clearTimeout(i),e(t))})["catch"](function(e){c||(clearTimeout(i),o(e))})}).then(function(e){return o=e,u=e.headers,s=e.status,a=e.statusText,r._checkForDeprecationHeader(u),r._checkForBackoffHeader(s,u),e.text()}).then(function(e){return 0===e.length?null:JSON.parse(e)})["catch"](function(e){var t=new Error("HTTP "+(s||0)+"; "+e);throw t.response=o,t.stack=e.stack,t}).then(function(e){if(e&&s>=400){var t="HTTP "+s+"; ";e.errno&&e.errno in _errorsJs2["default"]?(t+=_errorsJs2["default"][e.errno],e.message&&(t+=": "+e.message)):t+=a||"";var r=new Error(t.trim());throw r.response=o,r.data=e,r}return{status:s,json:e,headers:u}})}},{key:"_checkForDeprecationHeader",value:function(e){var t=e.get("Alert");if(t){var r=void 0;try{r=JSON.parse(t)}catch(n){return void console.warn("Unable to parse Alert header message",t)}console.warn(r.message,r.url),this.events.emit("deprecated",r)}}},{key:"_checkForBackoffHeader",value:function(e,t){var r=void 0,n=parseInt(t.get("Backoff"),10);r=n>0?(new Date).getTime()+1e3*n:0,this.events.emit("backoff",r)}}]),e}();exports["default"]=HTTP,module.exports=exports["default"];

},{"./errors.js":18}],20:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),_get=function(e,t,r){for(var a=!0;a;){var o=e,n=t,i=r;a=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,n);if(void 0!==u){if("value"in u)return u.value;var s=u.get;return void 0===s?void 0:s.call(i)}var l=Object.getPrototypeOf(o);if(null===l)return void 0;e=l,t=n,r=i,a=!0,u=l=void 0}},_events=require("events");require("babel/polyfill"),require("isomorphic-fetch");var _adaptersBase=require("./adapters/base"),_adaptersBase2=_interopRequireDefault(_adaptersBase),_adaptersLocalStorage=require("./adapters/LocalStorage"),_adaptersLocalStorage2=_interopRequireDefault(_adaptersLocalStorage),_adaptersIDB=require("./adapters/IDB"),_adaptersIDB2=_interopRequireDefault(_adaptersIDB),_KintoBase2=require("./KintoBase"),_KintoBase3=_interopRequireDefault(_KintoBase2),Kinto=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];_classCallCheck(this,t);var r={adapter:t.adapters.IDB,events:new _events.EventEmitter};_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,Object.assign({},r,e))}return _inherits(t,e),_createClass(t,null,[{key:"adapters",get:function(){return{BaseAdapter:_adaptersBase2["default"],LocalStorage:_adaptersLocalStorage2["default"],IDB:_adaptersIDB2["default"]}}}]),t}(_KintoBase3["default"]);exports["default"]=Kinto,module.exports=exports["default"];

},{"./KintoBase":12,"./adapters/IDB":13,"./adapters/LocalStorage":14,"./adapters/base":15,"babel/polyfill":1,"events":5,"isomorphic-fetch":2}],21:[function(require,module,exports){
"use strict";function deepEquals(e,t){try{(0,_assert.deepEqual)(e,t)}catch(r){return!1}return!0}function quote(e){return'"'+e+'"'}function unquote(e){return e.replace(/^"/,"").replace(/"$/,"")}function _isUndefined(e){return"undefined"==typeof e}function sortObjects(e,t){var r="-"===e[0],n=r?e.slice(1):e,u=r?-1:1;return t.slice().sort(function(e,t){return e[n]&&_isUndefined(t[n])?u:t[n]&&_isUndefined(e[n])?-u:_isUndefined(e[n])&&_isUndefined(t[n])?0:e[n]>t[n]?u:-u})}function filterObjects(e,t){return t.filter(function(t){return Object.keys(e).every(function(r){return t[r]===e[r]})})}function reduceRecords(e,t,r){return sortObjects(t,filterObjects(e,r))}function partition(e,t){return 0>=t?e:e.reduce(function(e,r,n){return 0===n||n%t===0?e.push([r]):e[e.length-1].push(r),e},[])}function isUUID(e){return RE_UUID.test(e)}function waterfall(e,t){return e.length?e.reduce(function(e,t){return e.then(t)},Promise.resolve(t)):Promise.resolve(t)}function pFinally(e,t){return e.then(function(e){return Promise.resolve(t()).then(function(){return e})},function(e){return Promise.resolve(t()).then(function(){throw e})})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.deepEquals=deepEquals,exports.quote=quote,exports.unquote=unquote,exports.sortObjects=sortObjects,exports.filterObjects=filterObjects,exports.reduceRecords=reduceRecords,exports.partition=partition,exports.isUUID=isUUID,exports.waterfall=waterfall,exports.pFinally=pFinally;var _assert=require("assert"),RE_UUID=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;

},{"assert":3}]},{},[20])(20)
});