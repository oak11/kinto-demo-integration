(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.KintoDiscovery = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";function _interopRequireDefault(r){return r&&r.__esModule?r:{"default":r}}function parseHexString(r){for(var e=[];r.length>=2;)e.push(parseInt(r.substring(0,2),16)),r=r.substring(2,r.length);return e}function getUserIDHash(r){var e=(0,_md2["default"])(r),t=parseHexString(e);return _uuid2["default"].v4({random:t})}function registerUserURL(r,e,t,s,i){var n=getUserIDHash(r),u="kinto:server-url:"+r,o=e+n,a=JSON.stringify({data:{url:s}});return t.hasOwnProperty("Authorization")?fetch(o,{method:"put",headers:t,body:a}).then(function(r){if(r.status>=200&&r.status<300)return i.setItem(u,s),s;if(401==r.status)throw new Error("Invalid Authentication headers.");if(r.status>=500)throw new Error("Server not available.");throw new Error("Central repository not correctly configured.")}):Promise.reject(new Error("Missing Authorization header."))}function retrieveUserURL(r,e,t,s,i){if(!s)return Promise.reject(new Error("defaultServer should be defined."));if(!t.hasOwnProperty("Authorization"))return Promise.reject(new Error("Missing Authorization header."));var n=getUserIDHash(r),u="kinto:server-url:"+r,o=i.getItem(u);if(null!=o)return Promise.resolve(o);var a=e+n;return fetch(a,{headers:t}).then(function(r){if(r.status>=200&&r.status<300)return r.json();if(404==r.status||403==r.status)return{data:{url:s}};if(401==r.status)throw new Error("Invalid Authentication headers.");if(r.status>=500)throw new Error("Server is not available.");throw new Error("Central repository not correctly configured.")}).then(function(r){return i.setItem(u,r.data.url),r.data.url})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getUserIDHash=getUserIDHash,exports.registerUserURL=registerUserURL,exports.retrieveUserURL=retrieveUserURL;var _md=require("md5"),_md2=_interopRequireDefault(_md),_uuid=require("uuid"),_uuid2=_interopRequireDefault(_uuid);require("isomorphic-fetch");

},{"isomorphic-fetch":4,"md5":5,"uuid":8}],2:[function(require,module,exports){
var charenc={utf8:{stringToBytes:function(n){return charenc.bin.stringToBytes(unescape(encodeURIComponent(n)))},bytesToString:function(n){return decodeURIComponent(escape(charenc.bin.bytesToString(n)))}},bin:{stringToBytes:function(n){for(var e=[],r=0;r<n.length;r++)e.push(255&n.charCodeAt(r));return e},bytesToString:function(n){for(var e=[],r=0;r<n.length;r++)e.push(String.fromCharCode(n[r]));return e.join("")}}};module.exports=charenc;

},{}],3:[function(require,module,exports){
!function(){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={rotl:function(r,t){return r<<t|r>>>32-t},rotr:function(r,t){return r<<32-t|r>>>t},endian:function(r){if(r.constructor==Number)return 16711935&t.rotl(r,8)|4278255360&t.rotl(r,24);for(var n=0;n<r.length;n++)r[n]=t.endian(r[n]);return r},randomBytes:function(r){for(var t=[];r>0;r--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(r){for(var t=[],n=0,o=0;n<r.length;n++,o+=8)t[o>>>5]|=r[n]<<24-o%32;return t},wordsToBytes:function(r){for(var t=[],n=0;n<32*r.length;n+=8)t.push(r[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(r){for(var t=[],n=0;n<r.length;n++)t.push((r[n]>>>4).toString(16)),t.push((15&r[n]).toString(16));return t.join("")},hexToBytes:function(r){for(var t=[],n=0;n<r.length;n+=2)t.push(parseInt(r.substr(n,2),16));return t},bytesToBase64:function(t){for(var n=[],o=0;o<t.length;o+=3)for(var e=t[o]<<16|t[o+1]<<8|t[o+2],u=0;4>u;u++)8*o+6*u<=8*t.length?n.push(r.charAt(e>>>6*(3-u)&63)):n.push("=");return n.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],o=0,e=0;o<t.length;e=++o%4)0!=e&&n.push((r.indexOf(t.charAt(o-1))&Math.pow(2,-2*e+8)-1)<<2*e|r.indexOf(t.charAt(o))>>>6-2*e);return n}};module.exports=t}();

},{}],4:[function(require,module,exports){
require("whatwg-fetch"),module.exports=self.fetch.bind(self);

},{"whatwg-fetch":9}],5:[function(require,module,exports){
!function(){var r=require("crypt"),e=require("charenc").utf8,n=require("is-buffer"),t=require("charenc").bin,i=function(o,u){o.constructor==String?o=u&&"binary"===u.encoding?t.stringToBytes(o):e.stringToBytes(o):n(o)?o=Array.prototype.slice.call(o,0):Array.isArray(o)||(o=o.toString());for(var s=r.bytesToWords(o),a=8*o.length,f=1732584193,c=-271733879,g=-1732584194,y=271733878,_=0;_<s.length;_++)s[_]=16711935&(s[_]<<8|s[_]>>>24)|4278255360&(s[_]<<24|s[_]>>>8);s[a>>>5]|=128<<a%32,s[(a+64>>>9<<4)+14]=a;for(var h=i._ff,v=i._gg,d=i._hh,l=i._ii,_=0;_<s.length;_+=16){var b=f,T=c,p=g,q=y;f=h(f,c,g,y,s[_+0],7,-680876936),y=h(y,f,c,g,s[_+1],12,-389564586),g=h(g,y,f,c,s[_+2],17,606105819),c=h(c,g,y,f,s[_+3],22,-1044525330),f=h(f,c,g,y,s[_+4],7,-176418897),y=h(y,f,c,g,s[_+5],12,1200080426),g=h(g,y,f,c,s[_+6],17,-1473231341),c=h(c,g,y,f,s[_+7],22,-45705983),f=h(f,c,g,y,s[_+8],7,1770035416),y=h(y,f,c,g,s[_+9],12,-1958414417),g=h(g,y,f,c,s[_+10],17,-42063),c=h(c,g,y,f,s[_+11],22,-1990404162),f=h(f,c,g,y,s[_+12],7,1804603682),y=h(y,f,c,g,s[_+13],12,-40341101),g=h(g,y,f,c,s[_+14],17,-1502002290),c=h(c,g,y,f,s[_+15],22,1236535329),f=v(f,c,g,y,s[_+1],5,-165796510),y=v(y,f,c,g,s[_+6],9,-1069501632),g=v(g,y,f,c,s[_+11],14,643717713),c=v(c,g,y,f,s[_+0],20,-373897302),f=v(f,c,g,y,s[_+5],5,-701558691),y=v(y,f,c,g,s[_+10],9,38016083),g=v(g,y,f,c,s[_+15],14,-660478335),c=v(c,g,y,f,s[_+4],20,-405537848),f=v(f,c,g,y,s[_+9],5,568446438),y=v(y,f,c,g,s[_+14],9,-1019803690),g=v(g,y,f,c,s[_+3],14,-187363961),c=v(c,g,y,f,s[_+8],20,1163531501),f=v(f,c,g,y,s[_+13],5,-1444681467),y=v(y,f,c,g,s[_+2],9,-51403784),g=v(g,y,f,c,s[_+7],14,1735328473),c=v(c,g,y,f,s[_+12],20,-1926607734),f=d(f,c,g,y,s[_+5],4,-378558),y=d(y,f,c,g,s[_+8],11,-2022574463),g=d(g,y,f,c,s[_+11],16,1839030562),c=d(c,g,y,f,s[_+14],23,-35309556),f=d(f,c,g,y,s[_+1],4,-1530992060),y=d(y,f,c,g,s[_+4],11,1272893353),g=d(g,y,f,c,s[_+7],16,-155497632),c=d(c,g,y,f,s[_+10],23,-1094730640),f=d(f,c,g,y,s[_+13],4,681279174),y=d(y,f,c,g,s[_+0],11,-358537222),g=d(g,y,f,c,s[_+3],16,-722521979),c=d(c,g,y,f,s[_+6],23,76029189),f=d(f,c,g,y,s[_+9],4,-640364487),y=d(y,f,c,g,s[_+12],11,-421815835),g=d(g,y,f,c,s[_+15],16,530742520),c=d(c,g,y,f,s[_+2],23,-995338651),f=l(f,c,g,y,s[_+0],6,-198630844),y=l(y,f,c,g,s[_+7],10,1126891415),g=l(g,y,f,c,s[_+14],15,-1416354905),c=l(c,g,y,f,s[_+5],21,-57434055),f=l(f,c,g,y,s[_+12],6,1700485571),y=l(y,f,c,g,s[_+3],10,-1894986606),g=l(g,y,f,c,s[_+10],15,-1051523),c=l(c,g,y,f,s[_+1],21,-2054922799),f=l(f,c,g,y,s[_+8],6,1873313359),y=l(y,f,c,g,s[_+15],10,-30611744),g=l(g,y,f,c,s[_+6],15,-1560198380),c=l(c,g,y,f,s[_+13],21,1309151649),f=l(f,c,g,y,s[_+4],6,-145523070),y=l(y,f,c,g,s[_+11],10,-1120210379),g=l(g,y,f,c,s[_+2],15,718787259),c=l(c,g,y,f,s[_+9],21,-343485551),f=f+b>>>0,c=c+T>>>0,g=g+p>>>0,y=y+q>>>0}return r.endian([f,c,g,y])};i._ff=function(r,e,n,t,i,o,u){var s=r+(e&n|~e&t)+(i>>>0)+u;return(s<<o|s>>>32-o)+e},i._gg=function(r,e,n,t,i,o,u){var s=r+(e&t|n&~t)+(i>>>0)+u;return(s<<o|s>>>32-o)+e},i._hh=function(r,e,n,t,i,o,u){var s=r+(e^n^t)+(i>>>0)+u;return(s<<o|s>>>32-o)+e},i._ii=function(r,e,n,t,i,o,u){var s=r+(n^(e|~t))+(i>>>0)+u;return(s<<o|s>>>32-o)+e},i._blocksize=16,i._digestsize=16,module.exports=function(e,n){if("undefined"!=typeof e){var o=r.wordsToBytes(i(e,n));return n&&n.asBytes?o:n&&n.asString?t.bytesToString(o):r.bytesToHex(o)}}}();

},{"charenc":2,"crypt":3,"is-buffer":6}],6:[function(require,module,exports){
module.exports=function(o){return!(null==o||!o.constructor||"function"!=typeof o.constructor.isBuffer||!o.constructor.isBuffer(o))};

},{}],7:[function(require,module,exports){
(function (global){
var rng;if(global.crypto&&crypto.getRandomValues){var _rnds8=new Uint8Array(16);rng=function(){return crypto.getRandomValues(_rnds8),_rnds8}}if(!rng){var _rnds=new Array(16);rng=function(){for(var r,n=0;16>n;n++)0===(3&n)&&(r=4294967296*Math.random()),_rnds[n]=r>>>((3&n)<<3)&255;return _rnds}}module.exports=rng;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],8:[function(require,module,exports){
function parse(e,s,r){var t=s&&r||0,n=0;for(s=s||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>n&&(s[t+n++]=_hexToByte[e])});16>n;)s[t+n++]=0;return s}function unparse(e,s){var r=s||0,t=_byteToHex;return t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]}function v1(e,s,r){var t=s&&r||0,n=s||[];e=e||{};var o=void 0!==e.clockseq?e.clockseq:_clockseq,a=void 0!==e.msecs?e.msecs:(new Date).getTime(),u=void 0!==e.nsecs?e.nsecs:_lastNSecs+1,c=a-_lastMSecs+(u-_lastNSecs)/1e4;if(0>c&&void 0===e.clockseq&&(o=o+1&16383),(0>c||a>_lastMSecs)&&void 0===e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=a,_lastNSecs=u,_clockseq=o,a+=122192928e5;var i=(1e4*(268435455&a)+u)%4294967296;n[t++]=i>>>24&255,n[t++]=i>>>16&255,n[t++]=i>>>8&255,n[t++]=255&i;var _=a/4294967296*1e4&268435455;n[t++]=_>>>8&255,n[t++]=255&_,n[t++]=_>>>24&15|16,n[t++]=_>>>16&255,n[t++]=o>>>8|128,n[t++]=255&o;for(var d=e.node||_nodeId,v=0;6>v;v++)n[t+v]=d[v];return s?s:unparse(n)}function v4(e,s,r){var t=s&&r||0;"string"==typeof e&&(s="binary"==e?new Array(16):null,e=null),e=e||{};var n=e.random||(e.rng||_rng)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,s)for(var o=0;16>o;o++)s[t+o]=n[o];return s||unparse(n)}for(var _rng=require("./rng"),_byteToHex=[],_hexToByte={},i=0;256>i;i++)_byteToHex[i]=(i+256).toString(16).substr(1),_hexToByte[_byteToHex[i]]=i;var _seedBytes=_rng(),_nodeId=[1|_seedBytes[0],_seedBytes[1],_seedBytes[2],_seedBytes[3],_seedBytes[4],_seedBytes[5]],_clockseq=16383&(_seedBytes[6]<<8|_seedBytes[7]),_lastMSecs=0,_lastNSecs=0,uuid=v4;uuid.v1=v1,uuid.v4=v4,uuid.parse=parse,uuid.unparse=unparse,module.exports=uuid;

},{"./rng":7}],9:[function(require,module,exports){
!function(t){"use strict";function e(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function r(t){return"string"!=typeof t&&(t=String(t)),t}function o(t){this.map={},t instanceof o?t.forEach(function(t,e){this.append(e,t)},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function n(t){return t.bodyUsed?Promise.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function s(t){return new Promise(function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}})}function i(t){var e=new FileReader;return e.readAsArrayBuffer(t),s(e)}function a(t){var e=new FileReader;return e.readAsText(t),s(e)}function h(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,"string"==typeof t)this._bodyText=t;else if(c.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(c.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(t){if(!c.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t))throw new Error("unsupported BodyInit type")}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type&&this.headers.set("content-type",this._bodyBlob.type))},c.blob?(this.blob=function(){var t=n(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(i)},this.text=function(){var t=n(this);if(t)return t;if(this._bodyBlob)return a(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var t=n(this);return t?t:Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(f)}),this.json=function(){return this.text().then(JSON.parse)},this}function u(t){var e=t.toUpperCase();return y.indexOf(e)>-1?e:t}function d(t,e){e=e||{};var r=e.body;if(d.prototype.isPrototypeOf(t)){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new o(t.headers)),this.method=t.method,this.mode=t.mode,r||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=t;if(this.credentials=e.credentials||this.credentials||"omit",(e.headers||!this.headers)&&(this.headers=new o(e.headers)),this.method=u(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function f(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var r=t.split("="),o=r.shift().replace(/\+/g," "),n=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(o),decodeURIComponent(n))}}),e}function p(t){var e=new o,r=t.getAllResponseHeaders().trim().split("\n");return r.forEach(function(t){var r=t.trim().split(":"),o=r.shift().trim(),n=r.join(":").trim();e.append(o,n)}),e}function l(t,e){e||(e={}),this.type="default",this.status=e.status,this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText,this.headers=e.headers instanceof o?e.headers:new o(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){o.prototype.append=function(t,o){t=e(t),o=r(o);var n=this.map[t];n||(n=[],this.map[t]=n),n.push(o)},o.prototype["delete"]=function(t){delete this.map[e(t)]},o.prototype.get=function(t){var r=this.map[e(t)];return r?r[0]:null},o.prototype.getAll=function(t){return this.map[e(t)]||[]},o.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},o.prototype.set=function(t,o){this.map[e(t)]=[r(o)]},o.prototype.forEach=function(t,e){Object.getOwnPropertyNames(this.map).forEach(function(r){this.map[r].forEach(function(o){t.call(e,o,r,this)},this)},this)};var c={blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t},y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];d.prototype.clone=function(){return new d(this)},h.call(d.prototype),h.call(l.prototype),l.prototype.clone=function(){return new l(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new o(this.headers),url:this.url})},l.error=function(){var t=new l(null,{status:0,statusText:""});return t.type="error",t};var b=[301,302,303,307,308];l.redirect=function(t,e){if(-1===b.indexOf(e))throw new RangeError("Invalid status code");return new l(null,{status:e,headers:{location:t}})},t.Headers=o,t.Request=d,t.Response=l,t.fetch=function(t,e){return new Promise(function(r,o){function n(){return"responseURL"in i?i.responseURL:/^X-Request-URL:/m.test(i.getAllResponseHeaders())?i.getResponseHeader("X-Request-URL"):void 0}var s;s=d.prototype.isPrototypeOf(t)&&!e?t:new d(t,e);var i=new XMLHttpRequest;i.onload=function(){var t=1223===i.status?204:i.status;if(100>t||t>599)return void o(new TypeError("Network request failed"));var e={status:t,statusText:i.statusText,headers:p(i),url:n()},s="response"in i?i.response:i.responseText;r(new l(s,e))},i.onerror=function(){o(new TypeError("Network request failed"))},i.open(s.method,s.url,!0),"include"===s.credentials&&(i.withCredentials=!0),"responseType"in i&&c.blob&&(i.responseType="blob"),s.headers.forEach(function(t,e){i.setRequestHeader(e,t)}),i.send("undefined"==typeof s._bodyInit?null:s._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this);

},{}]},{},[1])(1)
});